<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="generator" content="Hugo 0.17" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Let&#39;s Rock! &ndash; Nikolay Turpitko, Software Developer, Freelancer</title>
    
    
    <link rel="canonical" href="https://nikolay-turpitko.github.io/recent-projects/lr/">
    
    
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="data:image/vnd.microsoft.icon;base64,AAABAAEAEBACAAAAAACwAAAAFgAAACgAAAAQAAAAIAAAAAEAAQAAAAAAQAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAA////AAAAAAABgAAAAYAAAAGAAAABgAAAB+AAAAAAAAAAAAAAAAAAAAAAAAAGYAAABuAAAAfgAAAHYAAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">

    <style media="screen">
  html{font-size:12px}*{box-sizing:border-box;text-rendering:geometricPrecision}body{font-size:1rem;line-height:1.5rem;margin:0;font-family:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;word-wrap:break-word}h1,h2,h3,h4,h5,h6{line-height:1.3em}fieldset{border:none;padding:0;margin:0}pre{padding:2rem;margin:1.75rem 0;background-color:#fff;border:1px solid #ccc;overflow:auto}code[class*=language-],pre[class*=language-],pre code{font-weight:100;text-shadow:none;margin:1.75rem 0}a{cursor:pointer;color:#ff2e88;text-decoration:none;border-bottom:1px solid #ff2e88}a:hover{background-color:#ff2e88;color:#fff}.grid{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.grid.\-top{-ms-flex-align:start;-ms-grid-row-align:flex-start;align-items:flex-start}.grid.\-middle{-ms-flex-align:center;-ms-grid-row-align:center;align-items:center}.grid.\-bottom{-ms-flex-align:end;-ms-grid-row-align:flex-end;align-items:flex-end}.grid.\-stretch{-ms-flex-align:stretch;-ms-grid-row-align:stretch;align-items:stretch}.grid.\-baseline{-ms-flex-align:baseline;-ms-grid-row-align:baseline;align-items:baseline}.grid.\-left{-ms-flex-pack:start;justify-content:flex-start}.grid.\-center{-ms-flex-pack:center;justify-content:center}.grid.\-right{-ms-flex-pack:end;justify-content:flex-end}.grid.\-between{-ms-flex-pack:justify;justify-content:space-between}.grid.\-around{-ms-flex-pack:distribute;justify-content:space-around}.cell{-ms-flex:1;flex:1;box-sizing:border-box}@media screen and (min-width:768px){.cell.\-1of12{-ms-flex:0 0 8.33333%;flex:0 0 8.33333%}.cell.\-2of12{-ms-flex:0 0 16.66667%;flex:0 0 16.66667%}.cell.\-3of12{-ms-flex:0 0 25%;flex:0 0 25%}.cell.\-4of12{-ms-flex:0 0 33.33333%;flex:0 0 33.33333%}.cell.\-5of12{-ms-flex:0 0 41.66667%;flex:0 0 41.66667%}.cell.\-6of12{-ms-flex:0 0 50%;flex:0 0 50%}.cell.\-7of12{-ms-flex:0 0 58.33333%;flex:0 0 58.33333%}.cell.\-8of12{-ms-flex:0 0 66.66667%;flex:0 0 66.66667%}.cell.\-9of12{-ms-flex:0 0 75%;flex:0 0 75%}.cell.\-10of12{-ms-flex:0 0 83.33333%;flex:0 0 83.33333%}.cell.\-11of12{-ms-flex:0 0 91.66667%;flex:0 0 91.66667%}}@media screen and (max-width:768px){.grid{-ms-flex-direction:column;flex-direction:column}.cell{-ms-flex:0 0 auto;flex:0 0 auto}}.hack,.hack blockquote,.hack code,.hack em,.hack h1,.hack h2,.hack h3,.hack h4,.hack h5,.hack h6,.hack strong{font-size:1rem;font-style:normal;font-family:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif}.hack blockquote,.hack code,.hack em,.hack strong{line-height:20px}.hack blockquote,.hack code,.hack footer,.hack h1,.hack h2,.hack h3,.hack h4,.hack h5,.hack h6,.hack header,.hack li,.hack ol,.hack p,.hack section,.hack ul{float:none;margin:0;padding:0}.hack blockquote,.hack h1,.hack ol,.hack p,.hack ul{margin-top:20px;margin-bottom:20px}.hack h1{position:relative;display:inline-block;display:table-cell;padding:20px 0 30px;margin:0;overflow:hidden}.hack h1:after{content:"====================================================================================================";position:absolute;bottom:10px;left:0}.hack h1+*{margin-top:0}.hack h2,.hack h3,.hack h4,.hack h5,.hack h6{position:relative;margin-bottom:1.75rem}.hack h2:before,.hack h3:before,.hack h4:before,.hack h5:before,.hack h6:before{display:inline}.hack h2:before{content:"## "}.hack h3:before{content:"### "}.hack h4:before{content:"#### "}.hack h5:before{content:"##### "}.hack h6:before{content:"###### "}.hack li{position:relative;display:block;padding-left:20px}.hack li:after{position:absolute;top:0;left:0}.hack ul>li:after{content:"-"}.hack ol{counter-reset:a}.hack ol>li:after{content:counter(a) ".";counter-increment:a}.hack blockquote{position:relative;padding-left:17px;padding-left:2ch;overflow:hidden}.hack blockquote:after{content:">\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>";white-space:pre;position:absolute;top:0;left:0;line-height:20px}.hack em:after,.hack em:before{content:"*";display:inline}.hack pre code:after,.hack pre code:before{content:''}.hack code{font-weight:700}.hack code:after,.hack code:before{content:"`";display:inline}.hack hr{position:relative;height:20px;overflow:hidden;border:0;margin:20px 0}.hack hr:after{content:"----------------------------------------------------------------------------------------------------";position:absolute;top:0;left:0;line-height:20px;width:100%;word-wrap:break-word}@-moz-document url-prefix(){.hack h1{display:block}}.hack-ones ol>li:after{content:"1."}p{margin:0 0 1.75rem}.container{max-width:70rem}.container,.container-fluid{margin:0 auto;padding:0 1rem}.inner{padding:1rem}.inner2x{padding:2rem}.pull-left{float:left}.pull-right{float:right}.progress-bar{height:8px;opacity:.8;background-color:#ccc;margin-top:12px}.progress-bar.progress-bar-show-percent{margin-top:38px}.progress-bar-filled{background-color:gray;height:100%;transition:width .3s ease;position:relative;width:0}.progress-bar-filled:before{content:'';border:6px solid transparent;border-top-color:gray;position:absolute;top:-12px;right:-6px}.progress-bar-filled:after{color:gray;content:attr(data-filled);display:block;font-size:12px;white-space:nowrap;position:absolute;border:6px solid transparent;top:-38px;right:0;-ms-transform:translateX(50%);transform:translateX(50%)}table{width:100%;border-collapse:collapse;margin:1.75rem 0;color:#778087}table td,table th{vertical-align:top;border:1px solid #ccc;line-height:15px;padding:10px}table thead th{font-size:10px}table tbody td:first-child{font-weight:700;color:#333}.form{width:30rem}.form-group{margin-bottom:1.75rem;overflow:auto}.form-group label{border-bottom:2px solid #ccc;color:#333;width:10rem;display:inline-block;height:38px;line-height:38px;padding:0;float:left;position:relative}.form-group.form-success label{color:#4caf50!important;border-color:#4caf50!important}.form-group.form-warning label{color:#ff9800!important;border-color:#ff9800!important}.form-group.form-error label{color:#f44336!important;border-color:#f44336!important}.form-control{outline:none;border:none;border-bottom:2px solid #ccc;padding:.5rem 0;width:20rem;height:38px;background-color:transparent}.form-control:focus{border-color:#555}.form-group.form-textarea label:after{position:absolute;content:'';width:2px;background-color:#fff;right:-2px;top:0;bottom:0}textarea.form-control{height:auto;resize:none;padding:1rem 0;border-bottom:2px solid #ccc;border-left:2px solid #ccc;padding:.5rem}select.form-control{border-radius:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none}.help-block{color:#999;margin-top:.5rem}.form-actions{margin-bottom:1.75rem}.btn{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;outline:none;padding:.65rem 2rem;font-size:1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;z-index:1}.btn:active{box-shadow:inset 0 1px 3px rgba(0,0,0,.12)}.btn.btn-ghost{border-color:#757575;color:#757575;background-color:transparent}.btn.btn-ghost:focus,.btn.btn-ghost:hover{border-color:#424242;color:#424242;z-index:2}.btn.btn-ghost:hover{background-color:transparent}.btn-block{width:100%;display:-ms-flexbox;display:flex}.btn-default{color:#fff;background-color:#e0e0e0;border:1px solid #e0e0e0;color:#333}.btn-default:focus:not(.btn-ghost),.btn-default:hover{background-color:#dcdcdc;border-color:#dcdcdc}.btn-success{color:#fff;background-color:#4caf50;border:1px solid #4caf50}.btn-success:focus:not(.btn-ghost),.btn-success:hover{background-color:#43a047;border-color:#43a047}.btn-success.btn-ghost{border-color:#4caf50;color:#4caf50}.btn-success.btn-ghost:focus,.btn-success.btn-ghost:hover{border-color:#388e3c;color:#388e3c;z-index:2}.btn-error{color:#fff;background-color:#f44336;border:1px solid #f44336}.btn-error:focus:not(.btn-ghost),.btn-error:hover{background-color:#e53935;border-color:#e53935}.btn-error.btn-ghost{border-color:#f44336;color:#f44336}.btn-error.btn-ghost:focus,.btn-error.btn-ghost:hover{border-color:#d32f2f;color:#d32f2f;z-index:2}.btn-warning{color:#fff;background-color:#ff9800;border:1px solid #ff9800}.btn-warning:focus:not(.btn-ghost),.btn-warning:hover{background-color:#fb8c00;border-color:#fb8c00}.btn-warning.btn-ghost{border-color:#ff9800;color:#ff9800}.btn-warning.btn-ghost:focus,.btn-warning.btn-ghost:hover{border-color:#f57c00;color:#f57c00;z-index:2}.btn-info{color:#fff;background-color:#00bcd4;border:1px solid #00bcd4}.btn-info:focus:not(.btn-ghost),.btn-info:hover{background-color:#00acc1;border-color:#00acc1}.btn-info.btn-ghost{border-color:#00bcd4;color:#00bcd4}.btn-info.btn-ghost:focus,.btn-info.btn-ghost:hover{border-color:#0097a7;color:#0097a7;z-index:2}.btn-primary{color:#fff;background-color:#2196f3;border:1px solid #2196f3}.btn-primary:focus:not(.btn-ghost),.btn-primary:hover{background-color:#1e88e5;border-color:#1e88e5}.btn-primary.btn-ghost{border-color:#2196f3;color:#2196f3}.btn-primary.btn-ghost:focus,.btn-primary.btn-ghost:hover{border-color:#1976d2;color:#1976d2;z-index:2}.btn-group{overflow:auto}.btn-group .btn{float:left}.btn-group .btn-ghost:not(:first-child){margin-left:-1px}.card{border:1px solid #ccc}.card .card-header{color:#333;text-align:center;background-color:#ddd;padding:.5rem 0}.alert{color:#ccc;padding:1rem;border:1px solid #ccc;margin-bottom:1.75rem}.alert-success{color:#4caf50;border-color:#4caf50}.alert-error{color:#f44336;border-color:#f44336}.alert-info{color:#00bcd4;border-color:#00bcd4}.alert-warning{color:#ff9800;border-color:#ff9800}.media:not(:last-child){margin-bottom:1.25rem}.media-left{padding-right:1rem}.media-left,.media-right{display:table-cell;vertical-align:top}.media-right{padding-left:1rem}.media-body{display:table-cell;vertical-align:top}.media-heading{font-size:1.16667rem;font-weight:700}.media-content{margin-top:.3rem}.avatarholder,.placeholder{background-color:#f0f0f0;text-align:center;color:#b9b9b9;font-size:1rem;border:1px solid #f0f0f0}.avatarholder{width:48px;height:48px;line-height:46px;font-size:2rem;background-size:cover;background-position:50%;background-repeat:no-repeat}.avatarholder.rounded{border-radius:33px}.loading{height:20px;width:20px;animation:a .6s infinite linear;border:2px solid #e91e63;border-right-color:transparent;border-radius:50%}.btn .loading{display:inline-block;float:left;margin-right:.5rem;width:14px;height:14px}@keyframes a{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.menu{width:100%}.menu .menu-item{display:block;color:#616161;border-color:#616161}.menu .menu-item.active,.menu .menu-item:hover{color:#000;border-color:#000;background-color:transparent}@media screen and (max-width:768px){.form-group label{display:block;border-bottom:none;width:100%}.form-group.form-textarea label:after{display:none}.form-control{width:100%}textarea.form-control{border-left:none;padding:.5rem 0}pre::-webkit-scrollbar{height:3px}}@media screen and (max-width:480px){.form{width:100%}}
  .dark{color:#ccc}.dark,.dark pre{background-color:#000}.dark pre{padding:0;border:none}.dark pre code{color:#00bcd4}.dark h1 a,.dark h2 a,.dark h3 a,.dark h4 a,.dark h5 a{color:#ccc}.dark code,.dark strong{color:#fff}.dark code{font-weight:100}.dark table{color:#ccc}.dark table td,.dark table th{border-color:#444}.dark table tbody td:first-child{color:#fff}.dark .form-group label{color:#ccc;border-color:rgba(95,95,95,.78)}.dark .form-group.form-textarea label:after{background-color:#000}.dark .form-control{color:#ccc;border-color:rgba(95,95,95,.78)}.dark .form-control:focus{border-color:#ccc;color:#ccc}.dark textarea.form-control{color:#ccc}.dark .card{border-color:rgba(95,95,95,.78)}.dark .card .card-header{background-color:transparent;color:#ccc;border-bottom:1px solid rgba(95,95,95,.78)}.dark .btn.btn-ghost.btn-default{border-color:#ababab;color:#ababab}.dark .btn.btn-ghost.btn-default:focus,.dark .btn.btn-ghost.btn-default:hover{border-color:#9c9c9c;color:#9c9c9c;z-index:1}.dark .btn.btn-ghost.btn-default:focus,.dark .btn.btn-ghost.btn-default:hover{border-color:#e0e0e0;color:#e0e0e0}.dark .btn.btn-ghost.btn-primary:focus,.dark .btn.btn-ghost.btn-primary:hover{border-color:#64b5f6;color:#64b5f6}.dark .btn.btn-ghost.btn-success:focus,.dark .btn.btn-ghost.btn-success:hover{border-color:#81c784;color:#81c784}.dark .btn.btn-ghost.btn-info:focus,.dark .btn.btn-ghost.btn-info:hover{border-color:#4dd0e1;color:#4dd0e1}.dark .btn.btn-ghost.btn-error:focus,.dark .btn.btn-ghost.btn-error:hover{border-color:#e57373;color:#e57373}.dark .btn.btn-ghost.btn-warning:focus,.dark .btn.btn-ghost.btn-warning:hover{border-color:#ffb74d;color:#ffb74d}.dark .avatarholder,.dark .placeholder{background-color:transparent;border-color:#333}.dark .menu .menu-item{color:#ccc;border-color:rgba(95,95,95,.78)}.dark .menu .menu-item.active,.dark .menu .menu-item:hover{color:#fff;border-color:#ccc}
</style>

    <style media="screen">
  @keyframes intro {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
  .powered-by {
    color: rgba(95, 95, 95, 0.78);
  }
  main, footer {
    animation: intro 0.3s both;
    animation-delay: 0.15s;
  }
   
  .main {
    padding: 20px 10px;
  }
  nav a.active {
    background-color: #ff2e88;
    color: #fff;
  }
  html {
    font-size: 13px;
  }
  @media screen and (min-width: 768px) {
    html {
      font-size: 1em;
    }
    .container {
      max-width: 50rem;
    }
  }
</style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript">
        
        function rot(s, i) {
            return s.replace(/[a-zA-Z]/g, function (c) {
                return String.fromCharCode((c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + i) ? c : c - 26);
            });
        }
        $(function() {
            $('a[href^="mailto:"]').each(function() {
                this.href = this.href.replace(/[^:]+?$/, function(e) {
                    let r = rot(e.replace('[at]', '@').replace(/\[dot\]/g, '.'), 13);
                    return r;
                });
                this.innerHTML = this.href.replace('mailto:', '');
            });
            $('form[action^="https://formspree.io/"]').each(function() {
                this.action = this.action.replace(/[^\/]+?$/, function(e) {
                    let r = rot(e.replace('[at]', '@').replace(/\[dot\]/g, '.'), 13);
                    console.log(e, r);
                    return r;
                });
            });
        });
    </script>
    <style>
        em {
            font-style: italic !important;
        }
    </style>
  </head>
  <body class="hack dark main container">
    <header>
  
  <nav>
    
    
      <a class="" href="/">About</a>
    
      <a class="active" href="/recent-projects/">Recent projects</a>
    
      <a class="" href="/full-cv/">Full CV</a>
    
      <a class="" href="/downloads/">Download</a>
    
  </nav>


</header>
    <main>
  <h1>Let&#39;s Rock!</h1>
  

<p><a href="https://letsrock.today">https://letsrock.today</a></p>

<p><a href="https://play.google.com/store/apps/details?id=today.letsrock.client">At the Google Play</a></p>

<p><a href="https://github.com/letsrock-today">We</a> started this project along with
<a href="https://ru.linkedin.com/in/ustinovandrey">colleague and a friend of mine</a> a
couple of years ago.  Our main goal was to learn Go programming language, Linux
programming environment, and all the things, required for modern web
programming, especially free and open source tools, techniques and practises -
all that stuff, which we were discouraged to use during years of the work in
the Java/enterprise environment.</p>

<p>This is an ongoing project, it is neither completely finished nor abandoned.
We are doing it in our spare time, and it is not fully functional yet.</p>

<p>Sources are in the private repository. We hope to open it some day, but right
now we are ashamed to do this. I may show some parts as a code sample by request.
But the whole repository contains some sensitive parts. However, we started to
extract authentication code from this project into open-source one, see
<a href="../authkit">authkit</a>.</p>

<p>Basically, our server uses public API of several ticket sellers (similar to
<a href="https://seatgeek.com/">SeatGeek</a>) to retrieve information about entertainment
events into our database, index it and provide better search and filtering, as
well as additional features, like push notifications about new events,
conforming user-defined criteria. We also planned some social aspects, but
haven&rsquo;t implemented these ideas yet. Another planned, but not implemented yet
feature is to enrich information about events from the public media (Youtube,
Wikipedia, etc). So, basically, our app is an aggregator. But we are trying to
provide some additional services to the end user, and not pretend to be a
reseller. We do not (and not going to) sell anything within our app, we forward
traffic back to the partner site (with referral code, of course). This model is
not going to be very lucrative, but it&rsquo;s OK for start.</p>

<p>So far we created:</p>

<ul>
<li>back-end server on Go,</li>
<li>very basic web app (HTML5, <a href="riotjs.com/">Riot.js</a>),</li>
<li>more functional native Android app,</li>
<li>build and deployment automation scripts for the server.</li>
</ul>

<h2 id="server">Server</h2>

<p>We use Go-based services (we call them &ldquo;modules&rdquo;) behind the
<a href="https://nginx.org/en/">Nginx</a> server, working in the reverse proxy mode. Each
service focused on one task, has its own database and API.  Architecture is
not strictly &ldquo;micro-service&rdquo;, though, because services are relatively
coarse-grained and, moreover, we allowed them to share databases in some cases.
For example, we have services which populates data into the DB, and others that
perform search and returns data to the client app via API, they necessarily
share the same databases.</p>

<p>We use <a href="https://redis.io/">Redis</a> and <a href="http://ledisdb.com/">LedisDB</a> (with
<a href="http://leveldb.org/">LevelDB</a> back-end) databases, plus
<a href="http://sphinxsearch.com/">Sphinx</a> search engine.  Redis we use for small
frequently used objects (because Redis stores everything in RAM), LedisDB - for
all other things (which are stored mostly on HDD, but with
<a href="https://en.wikipedia.org/wiki/Memory-mapped_file">mmap</a> for faster read
access), and Sphinx stores indexes mostly. Each service has several logical
connections (we call them &ldquo;data sources&rdquo;) to the databases it needs. We are
striving to logically separate data sources, though, currently they may reside
within the same DB instance, and some services may use the same logical data
source by necessity.</p>

<p>We think, that with the current architecture we are well prepared to scale, if
necessary. Actually, we haven&rsquo;t proved this in practice yet. Currently we deploy
all the components onto the single virtual host with unix-socket connections
between them. But, theoretically, we can deploy Nginx, (multiple instances of)
every service and database (cluster) onto the separate nodes, using Nginx as a
load balancer.</p>

<p>We performed some stress tests on our current setup and monitored CPU, RAM and
HDD consumption growth and estimated, that we can grow up to 10K simultaneous
connections with only VDS hosting tariff plan upgrades, after that we have an
option to deploy databases onto separate nodes, which can give us some time to
prepare for the farther traffic growth. Still, it&rsquo;s all pure theoretical,
actually we&rsquo;d be quite happy to become popular enought to have a small
&ldquo;slashdot effect&rdquo;.</p>

<p>We used <a href="www.gorillatoolkit.org/">Gorilla toolkit</a> and <a href="https://github.com/urfave/negroni">Negroni
middleware</a> to implement services.  Each
service deployed as a separate <a href="http://rpm.org/">RPM package</a> (we use <a href="https://www.centos.org/">CentOS
Linux</a> in production).  Currently, to simplify
deployment and version control, we use single super-package, containing only
common initialization scripts and dependencies onto other app&rsquo;s packages.
However, we can deploy packages independently almost without interruption.
Services are completely stateless, behind the load balancer and we use graceful
shutdown to minimize loss of active connections.</p>

<p>We use <a href="https://www.freedesktop.org/wiki/Software/systemd/">systemd</a> to manage
our services. It capable to detect if processes are stuck or dead and restart
them automatically, if needed. We also used systemd&rsquo;s socket activation - mode
with which client connects to the socket, managed by systemd, so, socket would not
break if process crashed and restarted. We leveraged systemd&rsquo;s watchdog and
have quite a few of systemd timers.</p>

<p>One of the server&rsquo;s modules holds information about users. It also used as
a request handler of <a href="http://nginx.org/en/docs/http/ngx_http_auth_request_module.html">Nginx&rsquo;s http auth request
module</a>.  It
implements OAuth2 3-legged flow with
<a href="https://godoc.org/golang.org/x/oauth2">&ldquo;golang.org/x/oauth2&rdquo;</a>.  We started to
re-write it as an open-source project (see <a href="../authkit">authkit</a>).</p>

<h2 id="build-and-deployment-automation">Build and deployment automation</h2>

<p>We started to implement our build automation logic when
<a href="https://www.docker.com/">Docker</a> was young, and <a href="https://docs.docker.com/compose/">Docker
Compose</a> was to be born yet, so, we created
relatively complex make build to manage docker containers. We use docker
containers to:</p>

<ul>
<li>build binary files from Go sources for dev-test (and optionally execute unit
tests and lint),</li>
<li>setup dev-test environment (to perform integration tests - with databases,
Nginx, Sphinx, etc),</li>
<li>build RPMs (unit tests and lint run again as a part of this build).</li>
</ul>

<p>After RPM files are created with docker, make executes Packer and Vagrant to
prepare fresh test environment within virtual box, in which it executes tests
of the deployment, undeployment and some integration tests. This environment
closer resembles production, and allows us to find some issues which Docker
doesn&rsquo;t. For example, that&rsquo;s how we test required permissions, selinux rules,
etc.</p>

<p>We also use make and bash scripts, to prepare production server and to deploy
(or update) server application into production. No Puppet or Ansible at this
point, just don&rsquo;t need them yet.</p>

<h2 id="native-android-app">Native Android app</h2>

<p>For this project we decided to use native Android app. I have had awful
experiences with HTML5 / Apache Cordova app in <a href="../taxi">Taxi project</a>.</p>

<p>In our Android application we used following libraries:</p>

<ul>
<li><a href="http://androidannotations.org/">Android Annotations</a>,</li>
<li><a href="https://developer.android.com/training/volley/index.html">Volley</a>,</li>
<li><a href="https://developer.android.com/training/material/lists-cards.html">CardView and
RecyclerView</a>
from support library,</li>
<li><a href="https://firebase.google.com/">FireBase</a> for push notifications.</li>
</ul>

<p>To support custom OAuth2 login, we implemented <a href="https://developer.android.com/training/id-auth/custom_auth.html">Authenticator
Service</a> and
used WebViewClient to perform 3-legged flow (redirect user to the provider&rsquo;s
login page).</p>

<h2 id="web-app">Web app</h2>

<p>There is not much to say about the web app. It is HTML5 single-page app, created
with <a href="WebViewClient">Riot.js</a>. We used <a href="https://babeljs.io/docs/learn-es2015/">es6
(babel)</a>, <a href="https://www.npmjs.com/">npm</a>,
<a href="https://webpack.github.io/">webpack</a> and <a href="i18next.com/">i18next</a>.</p>

</main>
    <footer>
  
  <p class="powered-by">
    This page was generated by
    <a href="https://gohugo.io/">Hugo</a>
    using the
    <a href="https://comfusion.github.io/after-dark/">After Dark</a>
    theme by
    <a href="https://habd.as">Josh Habdas</a>.
  </p>


</footer>
    
  </body>
</html>
